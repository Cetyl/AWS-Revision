# VPC Project Overview

This project demonstrates how to create a Virtual Private Cloud (VPC) suitable for production environments, focusing on high availability, security, and scalability. By utilizing AWS services, we deploy servers in two Availability Zones (AZs), leveraging an Auto Scaling group and an Application Load Balancer (ALB).

## Table of Contents

- [Project Components](#project-components)
- [Architecture Diagram](#architecture-diagram)
- [Step-by-Step Implementation](#step-by-step-implementation)
  - [1. Creating the VPC](#1-creating-the-vpc)
  - [2. Subnets Configuration](#2-subnets-configuration)
  - [3. NAT Gateway Setup](#3-nat-gateway-setup)
  - [4. Launching EC2 Instances](#4-launching-ec2-instances)
  - [5. Configuring the Load Balancer](#5-configuring-the-load-balancer)
  - [6. Auto Scaling Group](#6-auto-scaling-group)
- [Security Considerations](#security-considerations)
- [Conclusion](#conclusion)

## Project Components

- **Virtual Private Cloud (VPC)**: The main networking environment where all components reside.
- **Subnets**: Logical partitions within the VPC that can be public or private.
- **NAT Gateway**: Enables instances in private subnets to initiate outbound traffic to the internet while preventing inbound traffic from the internet.
- **EC2 Instances**: The servers running your application, deployed in private subnets for security.
- **Application Load Balancer (ALB)**: Distributes incoming application traffic across multiple targets, enhancing availability and reliability.
- **Auto Scaling Group (ASG)**: Automatically adjusts the number of EC2 instances based on traffic demands, ensuring optimal performance and cost efficiency.

## Architecture Diagram

![vpc-example-private-subnets](https://github.com/user-attachments/assets/5395f915-f7f3-4331-93ae-a09dbd95cbbe)


*Figure 1: Architecture of the VPC with Auto Scaling and Load Balancer*

## Step-by-Step Implementation

### 1. Creating the VPC

1. **Log in to AWS Management Console.**
2. **Navigate to VPC Dashboard.**
3. **Create a new VPC:**
   - **CIDR Block**: `10.0.0.0/16` (provides a large address space for subnets)
   - **Name**: `ProductionVPC`
   - **Tenancy**: Default (use default instance tenancy)

### 2. Subnets Configuration

1. **Create Public Subnets:**
   - **First Public Subnet**:
     - **CIDR Block**: `10.0.1.0/24`
     - **Availability Zone**: `us-east-1a`
     - **Name**: `PublicSubnetA`
   - **Second Public Subnet**:
     - **CIDR Block**: `10.0.3.0/24`
     - **Availability Zone**: `us-east-1b`
     - **Name**: `PublicSubnetB`

2. **Create Private Subnets:**
   - **First Private Subnet**:
     - **CIDR Block**: `10.0.2.0/24`
     - **Availability Zone**: `us-east-1a`
     - **Name**: `PrivateSubnetA`
   - **Second Private Subnet**:
     - **CIDR Block**: `10.0.4.0/24`
     - **Availability Zone**: `us-east-1b`
     - **Name**: `PrivateSubnetB`

### 3. NAT Gateway Setup

1. **Create an Elastic IP:**
   - Navigate to **Elastic IPs** in the EC2 dashboard.
   - Allocate a new Elastic IP address.

2. **Create a NAT Gateway:**
   - Go to **NAT Gateways** in the VPC dashboard.
   - Click on **Create NAT Gateway**.
   - Select **Public Subnet** (either `PublicSubnetA` or `PublicSubnetB`).
   - Associate the Elastic IP you just created.

3. **Update Route Table of Private Subnets:**
   - Navigate to **Route Tables** in the VPC dashboard.
   - Select the route table associated with `PrivateSubnetA` and `PrivateSubnetB`.
   - Add a route:
     - **Destination**: `0.0.0.0/0`
     - **Target**: NAT Gateway

### 4. Launching EC2 Instances

1. **Create an EC2 Launch Template:**
   - Navigate to the **EC2 Dashboard**.
   - Click on **Launch Templates** and create a new one.
   - **Instance Type**: `t2.micro` (or other based on your requirements).
   - **AMI**: Select a suitable Amazon Machine Image (e.g., Amazon Linux 2).
   - **Key Pair**: Select or create a new key pair for SSH access.
   - **Security Group**: Create a new security group to allow inbound traffic for HTTP (port 80) and SSH (port 22).

2. **Launch EC2 Instances:**
   - Use the launch template to deploy instances in `PrivateSubnetA` and `PrivateSubnetB`.

### 5. Configuring the Load Balancer

1. **Create an Application Load Balancer:**
   - Navigate to **Load Balancers** in the EC2 dashboard.
   - Click on **Create Load Balancer** and select **Application Load Balancer**.
   - **Scheme**: `internet-facing`.
   - **VPC**: Select `ProductionVPC`.
   - **Subnets**: Select both `PublicSubnetA` and `PublicSubnetB`.

2. **Configure Listeners:**
   - **Listener**: HTTP on port 80.
   - **Default Action**: Forward to a new target group.

3. **Create Target Group:**
   - **Target Type**: Instance.
   - **Health Check Protocol**: HTTP.
   - **Health Check Path**: `/` (or your application path).

4. **Register Targets:**
   - Add your EC2 instances to the target group.

### 6. Auto Scaling Group

1. **Create an Auto Scaling Group using the Launch Template:**
   - Navigate to the **Auto Scaling Groups** section.
   - Click on **Create Auto Scaling group**.
   - Use the launch template created earlier.
   - **VPC**: Select `ProductionVPC`.
   - **Subnets**: Select `PrivateSubnetA` and `PrivateSubnetB`.

2. **Configure Scaling Policies:**
   - Set **Minimum Size**: 2.
   - Set **Desired Capacity**: 2.
   - Set **Maximum Size**: 5.
   - Create scaling policies based on CPU utilization or request count to maintain application performance.

3. **Attach the Auto Scaling Group to the Load Balancer.**

## Security Considerations

- **Security Groups**: Configure security groups to restrict traffic. Allow only necessary inbound and outbound rules.
  - **EC2 Security Group**: Allow HTTP (port 80) and SSH (port 22) only from trusted IPs.
  - **Load Balancer Security Group**: Allow HTTP (port 80) from anywhere (0.0.0.0/0) and restrict access to the EC2 instances.
  
- **Network ACLs**: Use Network ACLs to add an additional layer of security by controlling traffic to and from your subnets.

- **IAM Roles**: Assign least privilege IAM roles to EC2 instances to allow only necessary permissions for AWS resources.

## Conclusion

By following this guide, you have successfully created a resilient and secure VPC architecture in AWS, complete with EC2 instances deployed across multiple Availability Zones, managed by an Auto Scaling group and an Application Load Balancer. This setup not only enhances availability but also optimizes performance and security for your production environment.

For additional resources and detailed documentation, please refer to the [AWS VPC documentation](https://docs.aws.amazon.com/vpc/index.html).

---
